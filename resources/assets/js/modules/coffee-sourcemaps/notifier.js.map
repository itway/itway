{"version":3,"sources":["notifier.coffee"],"names":[],"mappings":";AAAA;;;;;;;;;;AAAA;EAUA,CAAC,CAAC,OAAO,CAAC,QAAV,GACE;IAAA,CAAA,EACE;MAAA,IAAA,EAAM,SAAA,GAAY,MAAM,CAAC,QAAQ,CAAC,QAAlC;MACA,MAAA,EAAQ,EAAA,CAAG,0BAAH,CADR;MAEA,WAAA,EAAa,CAAA,CAAE,SAAF,CAFb;MAGA,UAAA,EAAY,CAAA,CAAE,gBAAF,CAHZ;MAIA,SAAA,EAAW,CAAA,CAAE,YAAF,CAJX;MAKA,YAAA,EAAc,sDALd;MAMA,WAAA,EAAa,SAAC,IAAD,EAAO,QAAP,EAAiB,KAAjB,EAAwB,MAAxB;eACX,oDAAA,GAC+B,IAD/B,GACoC,qEADpC,GAG6C,QAH7C,GAGsD,iCAHtD,GAI8B,KAJ9B,GAIoC,uDAJpC,GAM+B,MAN/B,GAMsC;MAP3B,CANb;KADF;IAmBA,QAAA,EAAU,SAAA;AACR,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,kBAAN,CAAA;IAFQ,CAnBV;IAsBA,kBAAA,EAAoB,SAAA;AAClB,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,EAAf,CAAkB,iDAAlB,EACE,SAAC,OAAD;QACE,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,OAAnB,CAA2B,KAAK,CAAC,CAAC,CAAC,WAAR,CAAoB,CAAC,CAAC,IAAtB,EAA4B,OAAO,CAAC,IAAK,CAAA,CAAA,CAAzC,EAA6C,OAAO,CAAC,KAArD,EAA4D,OAAO,CAAC,IAAI,CAAC,IAAzE,CAA3B;eACA,KAAK,CAAC,gBAAN,CAAA;MAFF,CADF;IAFkB,CAtBpB;IA4BA,gBAAA,EAAkB,SAAA;AAChB,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC,OAAlB,CAA0B,kCAA1B;IAFgB,CA5BlB;IA+BA,mBAAA,EAAqB,SAAA;AACnB,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC,IAAlB,CAAuB,OAAvB,EAAgC,SAAA;QAC9B,IAAG,CAAA,CAAE,IAAF,CAAO,CAAC,IAAR,CAAa,iBAAb,CAA+B,CAAC,MAAhC,GAAyC,CAA5C;iBACE,CAAA,CAAE,IAAF,CAAO,CAAC,IAAR,CAAa,iBAAb,CAA+B,CAAC,MAAhC,CAAA,EADF;;MAD8B,CAAhC;IAFmB,CA/BrB;IAoCA,YAAA,EAAc,SAAA;AACZ,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC,MAAlB,CAAA;IAFY,CApCd;;;EAgDF,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAnB,CAAA;AA3DA","file":"notifier.js","sourceRoot":"/source/","sourcesContent":["### Notifier\r\n# ======\r\n# Notifies posts and notifies admin about the users and posts.\r\n#\r\n# @type Object\r\n# @usage $.ItwayIO.notifier.activate()\r\n#        $.ItwayIO.notifier.newPostCreated()\r\n#        $.ItwayIO.notifier.addNotifiedState()\r\n###\r\n\r\n$.ItwayIO.notifier =\r\n  o:\r\n    host: 'http://' + window.location.hostname\r\n    socket: io('http://www.itway.io:6378')\r\n    notifyBlock: $('.notify')\r\n    notifyArea: $('.notify .panel')\r\n    notifyBtn: $('#alertlink')\r\n    warningTempl: \"<div class=\\\"text-danger\\\">Something happened.</div>\"\r\n    notifyTempl: (host, instance, title, author) ->\r\n      \"<div class=\\\"activity\\\">\r\n          <a class=\\\"link\\\" href=\\\"#{host}\\\">\r\n            <span class=\\\"link-block\\\">\r\n              <span class=\\\"ui tag mini label\\\"> #{instance} </span>\r\n            <span class=\\\"title\\\">#{title}</span>\r\n            <span class=\\\"author\\\">\r\n              <span>author:</span> #{author}\r\n            </span>\r\n            </span>\r\n        </a>\r\n        </div>\"\r\n  activate: ->\r\n    _this = this\r\n    _this.newInstanceCreated()\r\n  newInstanceCreated: ->\r\n    _this = this\r\n    _this.o.socket.on 'post-created:itway\\\\Events\\\\PostWasCreatedEvent',\r\n      (message) ->\r\n        _this.o.notifyArea.prepend _this.o.notifyTempl(o.host, message.keys[0], message.title, message.user.name)\r\n        _this.addNotifiedState()\r\n  addNotifiedState: ->\r\n    _this = this\r\n    _this.o.notifyBtn.prepend '<span class=\"has-notify\"></span>'\r\n  removeNotifiedState: ->\r\n    _this = this\r\n    _this.o.notifyBtn.bind 'click', ->\r\n      if $(this).find('span.has-notify').length > 0\r\n        $(this).find('span.has-notify').remove()\r\n  toggleNotify: ->\r\n    _this = this\r\n    _this.o.notifyBtn.dropit()\r\n\r\n    # _this.o.notifyBtn.on \"click\", ->\r\n    #   if _this.o.notifyBlock.hasClass(\"active\")\r\n    #     _this.o.notifyBlock.removeClass(\"active\")\r\n    #   else _this.o.notifyBlock.addClass(\"active\")\r\n    #   _this.o.notifyBlock.on \"mouseleave\", (e) ->\r\n    #     $(\"body\").not(_this.o.notifyBlock).on \"click\", ->\r\n    #       if _this.o.notifyBlock.hasClass \"active\"\r\n    #         _this.o.notifyBlock.removeClass \"active\"\r\n$.ItwayIO.notifier.activate()\r\n"]}