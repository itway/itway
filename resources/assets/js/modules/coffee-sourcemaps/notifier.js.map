{"version":3,"sources":["notifier.coffee"],"names":[],"mappings":";AAAA;;;;;;;;;;AAAA;EAUA,CAAC,CAAC,OAAO,CAAC,QAAV,GACE;IAAA,CAAA,EACE;MAAA,IAAA,EAAM,SAAA,GAAY,MAAM,CAAC,QAAQ,CAAC,QAAlC;MACA,MAAA,EAAQ,EAAA,CAAG,OAAA,GAAQ,OAAX,CADR;MAEA,WAAA,EAAa,CAAA,CAAE,SAAF,CAFb;MAGA,UAAA,EAAY,CAAA,CAAE,gBAAF,CAHZ;MAIA,SAAA,EAAW,CAAA,CAAE,YAAF,CAJX;MAKA,YAAA,EAAc,sDALd;MAMA,WAAA,EAAa,SAAC,IAAD,EAAO,QAAP,EAAiB,IAAjB,EAAuB,KAAvB,EAA8B,MAA9B;eACX,mDAAA,GAC2B,IAD3B,GACgC,6GADhC,GAIwB,KAJxB,GAI8B,sDAJ9B,GAMsB,MANtB,GAM6B;MAPlB,CANb;KADF;IAiBA,QAAA,EAAU,SAAA;AACR,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,kBAAN,CAAA;IAFQ,CAjBV;IAoBA,kBAAA,EAAoB,SAAA;AAClB,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,CAAC,CAAC,MAAM,CAAC,EAAf,CAAkB,iDAAlB,EACE,SAAC,OAAD;QACE,KAAK,CAAC,CAAC,CAAC,UAAU,CAAC,OAAnB,CAA2B,KAAK,CAAC,CAAC,CAAC,WAAR,CAAoB,CAAC,CAAC,IAAtB,EAA4B,OAAO,CAAC,IAAK,CAAA,CAAA,CAAzC,EAA4C,OAAO,CAAC,IAAR,CAAa,OAAO,CAAC,KAArB,EAA4B,OAAO,CAAC,IAAI,CAAC,IAAzC,CAA5C,CAA3B;eACA,KAAK,CAAC,gBAAN,CAAA;MAFF,CADF;IAFkB,CApBpB;IA0BA,gBAAA,EAAkB,SAAA;AAChB,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC,OAAlB,CAA0B,kCAA1B;IAFgB,CA1BlB;IA6BA,mBAAA,EAAqB,SAAA;AACnB,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC,IAAlB,CAAuB,OAAvB,EAAgC,SAAA;QAC9B,IAAG,CAAA,CAAE,IAAF,CAAO,CAAC,IAAR,CAAa,iBAAb,CAA+B,CAAC,MAAhC,GAAyC,CAA5C;iBACE,CAAA,CAAE,IAAF,CAAO,CAAC,IAAR,CAAa,iBAAb,CAA+B,CAAC,MAAhC,CAAA,EADF;;MAD8B,CAAhC;IAFmB,CA7BrB;IAkCA,YAAA,EAAc,SAAA;AACZ,UAAA;MAAA,KAAA,GAAQ;aACR,KAAK,CAAC,CAAC,CAAC,SAAS,CAAC,MAAlB,CAAA;IAFY,CAlCd;;;EAqCF,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAnB,CAAA;AAhDA","file":"notifier.js","sourceRoot":"/source/","sourcesContent":["### Notifier\r\n# ======\r\n# Notifies posts and notifies admin about the users and posts.\r\n#\r\n# @type Object\r\n# @usage $.ItwayIO.notifier.activate()\r\n#        $.ItwayIO.notifier.newPostCreated()\r\n#        $.ItwayIO.notifier.addNotifiedState()\r\n###\r\n\r\n$.ItwayIO.notifier =\r\n  o:\r\n    host: 'http://' + window.location.hostname\r\n    socket: io(APP_URL+':6378')\r\n    notifyBlock: $('.notify')\r\n    notifyArea: $('.notify .panel')\r\n    notifyBtn: $('#alertlink')\r\n    warningTempl: \"<div class=\\\"text-danger\\\">Something happened.</div>\"\r\n    notifyTempl: (host, instance, link, title, author) ->\r\n      \"<li class=\\\"activity\\\">\r\n      <a class=\\\"link\\\" href=\\\"#{link}\\\">\r\n      <span class=\\\"ui tag tiny label\\\">@{instance}</span>\r\n      <span class=\\\"link-block\\\">\r\n      <span class=\\\"title\\\">#{title}</span>\r\n      <span class=\\\"author\\\">\r\n      <span>author:</span>#{author}</span>\r\n      </span></a>\r\n      </li>\"\r\n  activate: ->\r\n    _this = this\r\n    _this.newInstanceCreated()\r\n  newInstanceCreated: ->\r\n    _this = this\r\n    _this.o.socket.on 'post-created:itway\\\\Events\\\\PostWasCreatedEvent',\r\n      (message) ->\r\n        _this.o.notifyArea.prepend _this.o.notifyTempl(o.host, message.keys[0],message.link message.title, message.user.name)\r\n        _this.addNotifiedState()\r\n  addNotifiedState: ->\r\n    _this = this\r\n    _this.o.notifyBtn.prepend '<span class=\"has-notify\"></span>'\r\n  removeNotifiedState: ->\r\n    _this = this\r\n    _this.o.notifyBtn.bind 'click', ->\r\n      if $(this).find('span.has-notify').length > 0\r\n        $(this).find('span.has-notify').remove()\r\n  toggleNotify: ->\r\n    _this = this\r\n    _this.o.notifyBtn.dropit()\r\n$.ItwayIO.notifier.activate()\r\n"]}